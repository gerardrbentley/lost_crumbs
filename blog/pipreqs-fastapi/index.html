
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Spreading pinned dependencies one repo at a time.">
      
      
      
        <link rel="canonical" href="https://home.gerardbentley.com/blog/pipreqs-fastapi/">
      
      
        <link rel="prev" href="../personal-domain/">
      
      
        <link rel="next" href="../python-form-generator/">
      
      <link rel="icon" href="../../images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.0.2">
    
    
      
        <title>Pipreqs FastAPI Server + Github Bot - Lost Crumbs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.f56500e0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.2505c338.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/youtube.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Pipreqs FastAPI Server + Github Bot - Lost Crumbs" >
      
        <meta  property="og:description"  content="Spreading pinned dependencies one repo at a time." >
      
        <meta  property="og:image"  content="https://home.gerardbentley.com/assets/images/social/blog/pipreqs-fastapi.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://home.gerardbentley.com/blog/pipreqs-fastapi/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Pipreqs FastAPI Server + Github Bot - Lost Crumbs" >
      
        <meta  name="twitter:description"  content="Spreading pinned dependencies one repo at a time." >
      
        <meta  name="twitter:image"  content="https://home.gerardbentley.com/assets/images/social/blog/pipreqs-fastapi.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pipreqs-fastapi-server-github-bot" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Lost Crumbs" class="md-header__button md-logo" aria-label="Lost Crumbs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2c5.5 0 10 3.36 10 7.5 0 1.69-.74 3.25-2 4.5v8H4v-8c-1.26-1.25-2-2.81-2-4.5C2 5.36 6.5 2 12 2M8 18h4v-4H8v4Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Lost Crumbs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Pipreqs FastAPI Server + Github Bot
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/gerardrbentley/lost_crumbs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    gerardrbentley/lost_crumbs
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        Blog
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../guides/" class="md-tabs__link">
        Guides
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../resources/" class="md-tabs__link">
        Resources
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../setups/" class="md-tabs__link">
        Setups
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../tags/" class="md-tabs__link">
      Tags
    </a>
  </li>

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Lost Crumbs" class="md-nav__button md-logo" aria-label="Lost Crumbs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2c5.5 0 10 3.36 10 7.5 0 1.69-.74 3.25-2 4.5v8H4v-8c-1.26-1.25-2-2.81-2-4.5C2 5.36 6.5 2 12 2M8 18h4v-4H8v4Z"/></svg>

    </a>
    Lost Crumbs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/gerardrbentley/lost_crumbs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    gerardrbentley/lost_crumbs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../">Blog</a>
          
            <label for="__nav_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Blog" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Blog
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../bottle-htmx-streamlit/" class="md-nav__link">
        Bottle + HTMX vs Streamlit
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../brain-dump-2022/" class="md-nav__link">
        Brain Dump 2022
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../computer-vision-part-1/" class="md-nav__link">
        Computer Vision Part 1: Loading Images with Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../computer-vision-part-2/" class="md-nav__link">
        Computer Vision Part 2: Load Tagged Data With Pytorch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../computer-vision-part-3/" class="md-nav__link">
        Computer Vision Part 3: Train U-Net Architecture to predict UI segmentation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cte-subquery-who-gives-a-duck/" class="md-nav__link">
        CTE vs Subquery: Who gives a 🦆uck?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gitlab-workflow/" class="md-nav__link">
        Gitlab Workflow Project Management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../holy-duck/" class="md-nav__link">
        Holy 🦆uck! Fast Analysis with DuckDB + Pyarrow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../how-i-code/" class="md-nav__link">
        How I Edit Text Files (VS Code Settings)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lightgbm-water-pumps/" class="md-nav__link">
        LightGBM Predicting Water Pump Functionality
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../my-favorite-python-one-liner-sucks/" class="md-nav__link">
        My Favorite Python One Liner Sucks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../personal-domain/" class="md-nav__link">
        Share a website to the world in less than a day (Free for Students!)
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Pipreqs FastAPI Server + Github Bot
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Pipreqs FastAPI Server + Github Bot
      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="Page Index">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Page Index
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#python-pipreqs-api-github-bot" class="md-nav__link">
    Python Pipreqs API + Github Bot
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-use" class="md-nav__link">
    How to Use
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#background" class="md-nav__link">
    Background
  </a>
  
    <nav class="md-nav" aria-label="Background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deployments" class="md-nav__link">
    Deployments
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#manual-method" class="md-nav__link">
    Manual Method
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python-method" class="md-nav__link">
    Python Method
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-endpoint" class="md-nav__link">
    API Endpoint
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#async-python" class="md-nav__link">
    Async Python
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#primary-function" class="md-nav__link">
    Primary Function
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#caching" class="md-nav__link">
    Caching
  </a>
  
    <nav class="md-nav" aria-label="Caching">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#singular-cache" class="md-nav__link">
    Singular Cache
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-the-cache" class="md-nav__link">
    Using the cache
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#github-bot" class="md-nav__link">
    Github Bot
  </a>
  
    <nav class="md-nav" aria-label="Github Bot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#webhooks" class="md-nav__link">
    Webhooks
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gidgethub-endpoint-the-bot" class="md-nav__link">
    Gidgethub Endpoint (the bot)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automatically-opening-an-issue" class="md-nav__link">
    Automatically Opening an Issue
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing" class="md-nav__link">
    Testing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    Next Steps
  </a>
  
    <nav class="md-nav" aria-label="Next Steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bot" class="md-nav__link">
    Bot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api" class="md-nav__link">
    API
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../python-form-generator/" class="md-nav__link">
        Python Form Generator (JSON to Streamlit Form!)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../run-python/" class="md-nav__link">
        3 Ways to Run Python Code
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../streamlit-fullstack/" class="md-nav__link">
        Streamlit Full Stack Part 1: Python Web App in One File
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../streamlit-url-scan/" class="md-nav__link">
        Scanning URLs from Images
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../terminal/" class="md-nav__link">
        The Terminal (/ Shell / Command Line / Console)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../timeseries-part-1/" class="md-nav__link">
        Time Series Data Part 1: What is a Time Series?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../timeseries-part-2/" class="md-nav__link">
        Time Series Data Part 2: Darts and Streamlit
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../timeseries-part-3/" class="md-nav__link">
        Time Series Data Part 3: Custom Model Tuning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../timeseries-part-4/" class="md-nav__link">
        Time Series Data Part 4: A Full Stack Use Case
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../vgac-tagging/" class="md-nav__link">
        Custom Data Tagging with Python OpenCV
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../weather-forecast-dashboard/" class="md-nav__link">
        Checking 48 Mountain Weather Locations at Once
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../guides/">Guides</a>
          
            <label for="__nav_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Guides" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/geoparquet_intro/" class="md-nav__link">
        GeoParquet Intro
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/golang_postgres_stack/" class="md-nav__link">
        Project Golang Postgres Stack
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/golang_postgres_streamlit_stack/" class="md-nav__link">
        Project Golang Postgres Streamlit Stack
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/golang_webserver/" class="md-nav__link">
        Project Golang Webserver
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../resources/">Resources</a>
          
            <label for="__nav_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Resources" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Resources
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/ci_cd/" class="md-nav__link">
        CI/CD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/circleci/" class="md-nav__link">
        CircleCI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/curl/" class="md-nav__link">
        curl
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/frontend/" class="md-nav__link">
        Frontend
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/gatsby/" class="md-nav__link">
        Gatsby
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/git/" class="md-nav__link">
        Git
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/gitlab/" class="md-nav__link">
        Gitlab
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/golang/" class="md-nav__link">
        Golang
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/graphql/" class="md-nav__link">
        GraphQL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/heroku/" class="md-nav__link">
        Heroku
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/javascript/" class="md-nav__link">
        Javascript
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/linux/" class="md-nav__link">
        Linux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/local_network/" class="md-nav__link">
        Local Network
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/local_server/" class="md-nav__link">
        Local Server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/machine_learning/" class="md-nav__link">
        Machine Learning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/markdown/" class="md-nav__link">
        Markdown
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/node/" class="md-nav__link">
        Node JS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/open_source/" class="md-nav__link">
        Open Source
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/postgres/" class="md-nav__link">
        Postgres
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/python/" class="md-nav__link">
        Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/react/" class="md-nav__link">
        React JS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/reverse_proxy/" class="md-nav__link">
        Reverse Proxy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/scp/" class="md-nav__link">
        SCP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/time_series/" class="md-nav__link">
        Time Series
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/windows/" class="md-nav__link">
        Windows
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/yaml/" class="md-nav__link">
        YAML
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../setups/">Setups</a>
          
            <label for="__nav_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Setups" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Setups
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../setups/docker/" class="md-nav__link">
        Docker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../setups/domain/" class="md-nav__link">
        Domain Name
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../setups/git/" class="md-nav__link">
        Git
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../setups/golang/" class="md-nav__link">
        Golang
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../setups/ide/" class="md-nav__link">
        IDE
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../setups/macos/" class="md-nav__link">
        macOS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../setups/nginx_proxy_manager/" class="md-nav__link">
        Nginx Proxy Manager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../setups/postgres/" class="md-nav__link">
        Postgres
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../setups/python/" class="md-nav__link">
        Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../setups/ssh/" class="md-nav__link">
        SSH
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../setups/terminal/" class="md-nav__link">
        Terminal
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../setups/vps/" class="md-nav__link">
        VPS
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../tags/" class="md-nav__link">
        Tags
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="Page Index">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Page Index
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#python-pipreqs-api-github-bot" class="md-nav__link">
    Python Pipreqs API + Github Bot
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-use" class="md-nav__link">
    How to Use
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#background" class="md-nav__link">
    Background
  </a>
  
    <nav class="md-nav" aria-label="Background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deployments" class="md-nav__link">
    Deployments
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#manual-method" class="md-nav__link">
    Manual Method
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python-method" class="md-nav__link">
    Python Method
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-endpoint" class="md-nav__link">
    API Endpoint
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#async-python" class="md-nav__link">
    Async Python
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#primary-function" class="md-nav__link">
    Primary Function
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#caching" class="md-nav__link">
    Caching
  </a>
  
    <nav class="md-nav" aria-label="Caching">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#singular-cache" class="md-nav__link">
    Singular Cache
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-the-cache" class="md-nav__link">
    Using the cache
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#github-bot" class="md-nav__link">
    Github Bot
  </a>
  
    <nav class="md-nav" aria-label="Github Bot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#webhooks" class="md-nav__link">
    Webhooks
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gidgethub-endpoint-the-bot" class="md-nav__link">
    Gidgethub Endpoint (the bot)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automatically-opening-an-issue" class="md-nav__link">
    Automatically Opening an Issue
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing" class="md-nav__link">
    Testing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    Next Steps
  </a>
  
    <nav class="md-nav" aria-label="Next Steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bot" class="md-nav__link">
    Bot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api" class="md-nav__link">
    API
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  
  

  <nav class="md-tags" >
    
      
      
        <a href="../../tags/#python" class="md-tag">python</a>
      
    
      
      
        <a href="../../tags/#intermediate" class="md-tag">intermediate</a>
      
    
      
      
        <a href="../../tags/#fastapi" class="md-tag">fastapi</a>
      
    
  </nav>



  
  



<h1 id="pipreqs-fastapi-server-github-bot">Pipreqs FastAPI Server + Github Bot<a class="headerlink" href="#pipreqs-fastapi-server-github-bot" title="Permanent link">🔗</a></h1>
<h2 id="python-pipreqs-api-github-bot">Python Pipreqs API + Github Bot<a class="headerlink" href="#python-pipreqs-api-github-bot" title="Permanent link">🔗</a></h2>
<p>tl;dr: <a href="https://github.com/gerardrbentley/pipreqs-api">repo link</a></p>
<blockquote class="twitter-tweet" data-theme="dark"><p lang="en" dir="ltr">Turned my <a href="https://twitter.com/hashtag/Python?src=hash&amp;ref_src=twsrc%5Etfw">#Python</a> requirements API into a <a href="https://twitter.com/github?ref_src=twsrc%5Etfw">@github</a> <a href="https://twitter.com/hashtag/bot?src=hash&amp;ref_src=twsrc%5Etfw">#bot</a> that reminds me when I forget to update dependencies! 🤖<br><br>I used httpx and gidgethub, deployed with the existing <a href="https://twitter.com/FastAPI?ref_src=twsrc%5Etfw">@FastAPI</a> server on <a href="https://twitter.com/heroku?ref_src=twsrc%5Etfw">@heroku</a> <br><br>Followed a great guide by <a href="https://twitter.com/mariatta?ref_src=twsrc%5Etfw">@mariatta</a> -&gt; <a href="https://t.co/3GthR5urKe">https://t.co/3GthR5urKe</a> <a href="https://t.co/ARQw007LEQ">https://t.co/ARQw007LEQ</a> <a href="https://t.co/WRbuxvF3qA">pic.twitter.com/WRbuxvF3qA</a></p>&mdash; @gar@gerardbentley.com (@GarsBar35Plus) <a href="https://twitter.com/GarsBar35Plus/status/1520075920853274625?ref_src=twsrc%5Etfw">April 29, 2022</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>Powered by <a href="https://github.com/tiangolo/fastapi">FastAPI</a>, <a href="https://github.com/bndr/pipreqs">pipreqs</a>, and <a href="https://gidgethub.readthedocs.io/en/latest/index.html">gidgethub</a>.
Specifically, FastAPI runs the API server for receiving requests, pipreqs does the code requirements assessing, and gidgethub handles routing requests from Github Webhooks.</p>
<p>Basic API to power bots / helpers to rid the world of Python projects without correct requirements!
Simple bot to open an issue if <code>requirements.txt</code> doesn't match the output of <code>pipreqs</code>.</p>
<p>Attempts to shallow <code>git clone</code> a given repo then run <code>pipreqs</code> on the codebase.
Returns the resulting <code>requirements.txt</code> contents!</p>
<h2 id="how-to-use">How to Use<a class="headerlink" href="#how-to-use" title="Permanent link">🔗</a></h2>
<ul>
<li>Use the <a href="https://gerardrbentley.github.io/pipreqs-api/">pyscript frontend on github pages</a></li>
<li>Use the <a href="https://share.streamlit.io/gerardrbentley/pipreqs-api/streamlit_deploy/streamlit_app/streamlit_app.py">Streamlit frontend</a> 🎈</li>
<li>Use the fastapi generated <a href="https://pipreqs-api.herokuapp.com/docs#/default/pipreqs_endpoint_pipreqs_get">swagger docs</a></li>
<li>Use <code>curl</code> or other http client</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a>curl<span class="w"> </span><span class="s2">&quot;https://pipreqs-api.herokuapp.com/pipreqs?code_url=https://github.com/gerardrbentley/pipreqs-api&quot;</span>
</code></pre></div></td></tr></table></div>
<p>Response</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span>
<span class="normal"><a href="#__codelineno-1-2">2</a></span>
<span class="normal"><a href="#__codelineno-1-3">3</a></span>
<span class="normal"><a href="#__codelineno-1-4">4</a></span>
<span class="normal"><a href="#__codelineno-1-5">5</a></span>
<span class="normal"><a href="#__codelineno-1-6">6</a></span>
<span class="normal"><a href="#__codelineno-1-7">7</a></span>
<span class="normal"><a href="#__codelineno-1-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a>cachetools==5.0.0
<a id="__codelineno-1-2" name="__codelineno-1-2"></a>fastapi==0.75.2
<a id="__codelineno-1-3" name="__codelineno-1-3"></a>gidgethub==5.1.0
<a id="__codelineno-1-4" name="__codelineno-1-4"></a>httpx==0.22.0
<a id="__codelineno-1-5" name="__codelineno-1-5"></a>pydantic==1.9.0
<a id="__codelineno-1-6" name="__codelineno-1-6"></a>pytest==7.1.2
<a id="__codelineno-1-7" name="__codelineno-1-7"></a>streamlit==1.8.1
<a id="__codelineno-1-8" name="__codelineno-1-8"></a>uvicorn==0.17.6
</code></pre></div></td></tr></table></div>
<h2 id="background">Background<a class="headerlink" href="#background" title="Permanent link">🔗</a></h2>
<p>Python is a popular language, but it lacks a standard build &amp; dependency management tool.
The official docs recommend the third party <a href="https://packaging.python.org/en/latest/tutorials/managing-dependencies/">pipenv</a>, and others such as <a href="https://python-poetry.org/">poetry</a> and <a href="https://www.pantsbuild.org/">pants</a> are available for other preferences.
Even <a href="https://anaconda.org/">conda</a> can provide environment and dependency management!</p>
<p>Slowing things down, the basic way of installing Python packages is with <a href="https://pip.pypa.io/en/stable/"><code>pip</code></a> and a file called <code>requirements.txt</code> (which is a list of packages like the one above!)</p>
<p>Common guides will recommend running something like:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</code></pre></div></td></tr></table></div>
<p>Or maybe this to make sure the active Python environment's pip gets used:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a>python<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</code></pre></div></td></tr></table></div>
<h3 id="deployments">Deployments<a class="headerlink" href="#deployments" title="Permanent link">🔗</a></h3>
<p>This project had the goal of reducing headaches from the following loop:</p>
<ul>
<li>Write code for a Python / Streamlit app</li>
<li>Push the code to a github repo</li>
<li>Connect the repo to Streamlit Cloud</li>
<li>Wait for deploy on Streamlit Cloud</li>
<li>Get <code>"No module named"</code> or other error from not having up-to-date requirements</li>
</ul>
<p>So why is this the way it is?</p>
<p>I could say it's because "Python lacks a standard build &amp; dependency management tool", but I know that a simple build script / <a href="https://docs.docker.com/engine/reference/builder/">Dockerfile</a> and something like <a href="https://pre-commit.com/">pre-commit</a> can prevent these headaches before pushing code.</p>
<p>So then the answer is a combination of laziness and a desire to not bloat every repo with many tools and scripts.
Part of the beauty of managed application hosts such as <a href="https://heroku.com/">Heroku</a> and <a href="https://streamlit.io/cloud">Streamlit Cloud</a> is the minimal amount of setup needed to launch your app.</p>
<p>A truly minimal Streamlit Cloud repo just needs the <code>.py</code> file that holds the <code>streamlit</code> calls.
Once your app needs more third party Python packages than <code>streamlit</code>, some kind of dependency file is needed for the Platform to know how to install and run your app.</p>
<h2 id="manual-method">Manual Method<a class="headerlink" href="#manual-method" title="Permanent link">🔗</a></h2>
<p>The essence of this API and bot can be boiled down to 2 CLI calls:</p>
<ul>
<li><code>git clone --depth 1</code></li>
<li><code>pipreqs --print</code></li>
</ul>
<p>The clone command will download a copy of the repository that we want to check for requirements.
The <code>--depth 1</code> flag is important to limit how many files get downloaded (we don't need the whole repo history, just the latest).</p>
<p><a href="https://github.com/bndr/pipreqs">pipreqs</a> is a tool that analyzes a directory containing Python files and aims to produce a <code>requirements.txt</code> file with every third party package that is imported in the project directory.
The <code>--print</code> flag will tell pipreqs not to produce a file, but just to print out the file contents to stdout.</p>
<p>You can try this on your own!</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span>
<span class="normal"><a href="#__codelineno-4-2">2</a></span>
<span class="normal"><a href="#__codelineno-4-3">3</a></span>
<span class="normal"><a href="#__codelineno-4-4">4</a></span>
<span class="normal"><a href="#__codelineno-4-5">5</a></span>
<span class="normal"><a href="#__codelineno-4-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a>git<span class="w"> </span>clone<span class="w"> </span>--depth<span class="w"> </span><span class="m">1</span><span class="w"> </span>https://github.com/gerardrbentley/pipreqs-api<span class="w"> </span>test_dir
<a id="__codelineno-4-2" name="__codelineno-4-2"></a>python<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>pipreqs
<a id="__codelineno-4-3" name="__codelineno-4-3"></a>pipreqs<span class="w"> </span>--print<span class="w"> </span>test_dir
<a id="__codelineno-4-4" name="__codelineno-4-4"></a>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="c1"># clean up</span>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a>rm<span class="w"> </span>-r<span class="w"> </span>test_dir
</code></pre></div></td></tr></table></div>
<h2 id="python-method">Python Method<a class="headerlink" href="#python-method" title="Permanent link">🔗</a></h2>
<p>From Python we can either use a library such as <a href="https://gitpython.readthedocs.io/en/stable/reference.html?highlight=clone#git.repo.base.Repo.clone">gitpython</a>, or make the system call to <code>git</code> with the <a href="https://docs.python.org/3/library/subprocess.html">subprocess</a> standard library module.</p>
<p>Here is a basic example (using <code>.split()</code> to avoid using <a href="https://docs.python.org/3/library/subprocess.html#frequently-used-arguments">shell execution</a>)</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span>
<span class="normal"><a href="#__codelineno-5-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="kn">import</span> <span class="nn">subprocess</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;git clone --depth 1 https://github.com/gerardrbentley/pipreqs-api test_dir&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<p>Since <code>pipreqs</code> uses <a href="http://docopt.org/"><code>docopt</code></a> to <a href="https://github.com/bndr/pipreqs/blob/a593d27e3d9fcdecc0fbf385ef43116cccad71ec/pipreqs/pipreqs.py#L483">parse CLI arguments</a>, I figured it would be easy enough to repeat the <code>subprocess</code> pattern and be sure to capture the stdout output (the requirements!)</p>
<h2 id="api-endpoint">API Endpoint<a class="headerlink" href="#api-endpoint" title="Permanent link">🔗</a></h2>
<p>For users to access our function over the internet (and for bots 🤖 to access it!) we'll serve it up in a REST API.
Python has plenty of <a href="https://www.techempower.com/benchmarks/#section=data-r20&amp;hw=ph&amp;test=composite&amp;l=zijzen-sf">web framework libraries</a>, pretty much any of them would handle this fine.</p>
<p>For version 1 of this system I've chosen to have a single endpoint that responds to HTTP GET requests and requires a query argument called <code>code_url</code>.
All it will respond with is plain text containing the <code>requirements.txt</code> contents and a <code>200</code> status code.</p>
<p>Here's what that looks like in my FastAPI app:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span>
<span class="normal"><a href="#__codelineno-6-2">2</a></span>
<span class="normal"><a href="#__codelineno-6-3">3</a></span>
<span class="normal"><a href="#__codelineno-6-4">4</a></span>
<span class="normal"><a href="#__codelineno-6-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="nd">@router</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/pipreqs&quot;</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">PlainTextResponse</span><span class="p">)</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="k">async</span> <span class="k">def</span> <span class="nf">pipreqs_endpoint</span><span class="p">(</span><span class="n">code_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-6-3" name="__codelineno-6-3"></a>    <span class="o">...</span> <span class="c1"># Clone the repo from code_url</span>
<a id="__codelineno-6-4" name="__codelineno-6-4"></a>    <span class="o">...</span> <span class="c1"># Run pipreqs on the cloned repo</span>
<a id="__codelineno-6-5" name="__codelineno-6-5"></a>    <span class="k">return</span> <span class="n">requirements</span>
</code></pre></div></td></tr></table></div>
<h2 id="async-python">Async Python<a class="headerlink" href="#async-python" title="Permanent link">🔗</a></h2>
<p>This method so far works fine for a single user, but imagine the system with multiple users / bots making requests at once.
Each <code>git clone</code> and <code>pipreqs</code> call would have to complete for a single user before the next in the queue can be processed.</p>
<p><code>git clone</code> relies on the I/O speed of our server to write files, the remote git server to read the files, and the network speed to get them to our server.
<code>pipreqs</code> includes synchronous <code>requests</code> calls to <a href="https://pypi.org/">pypi</a>, so it relies on the response speed of the pypi server and the I/O speed of our server to loop over project files and run <code>ast.parse</code> (from <a href="https://docs.python.org/3/library/ast.html#ast.parse">standard library</a>) on the <code>.py</code> files.</p>
<p>WSGI frameworks such as <a href="https://flask.palletsprojects.com/en/2.1.x/">Flask</a> and <a href="https://bottlepy.org/">Bottle</a> rely on threading tricks such as gevent <em>greenlets</em> (read more <a href="https://bottlepy.org/docs/dev/async.html">from Bottle</a>) to handle many connections in a single process.
ASGI frameworks such as FastAPI (built on <a href="https://www.starlette.io/">Starlette</a>) instead rely on a single-threaded event loop and async coroutines to handle many connections.</p>
<p>Above we defined the <code>/pipreqs</code> route handler with <code>async def</code> function.
In FastAPI our function will already be running in the event loop so we can use <code>await</code> in our code to utilize other <code>async</code> functions!</p>
<p>Speaking of other <code>async</code> functions, we can swap out the synchronous <code>subprocess.run()</code> with another standard library function <code>asyncio.create_subprocess_exec()</code> (see the <a href="https://docs.python.org/3/library/asyncio-subprocess.html#subprocesses">asyncio subprocess docs</a>).
This will ensure that our program can let <code>git clone</code> and <code>pipreqs</code> run without hanging up our server process when there's no work to check on.</p>
<p>A general asynchronous run function using exec needs a try block (using <code>create_subprocess_shell</code> will return the errors in <code>stderr</code> without raising).</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-7-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-7-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-7-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-7-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-7-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-7-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-7-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-7-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-7-10">10</a></span>
<span class="normal"><a href="#__codelineno-7-11">11</a></span>
<span class="normal"><a href="#__codelineno-7-12">12</a></span>
<span class="normal"><a href="#__codelineno-7-13">13</a></span>
<span class="normal"><a href="#__codelineno-7-14">14</a></span>
<span class="normal"><a href="#__codelineno-7-15">15</a></span>
<span class="normal"><a href="#__codelineno-7-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="kn">import</span> <span class="nn">asyncio</span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Tuple</span>
<a id="__codelineno-7-3" name="__codelineno-7-3"></a>
<a id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="k">async</span> <span class="k">def</span> <span class="nf">_run</span><span class="p">(</span><span class="n">cmd</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-7-5" name="__codelineno-7-5"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-7-6" name="__codelineno-7-6"></a>        <span class="n">proc</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_subprocess_exec</span><span class="p">(</span>
<a id="__codelineno-7-7" name="__codelineno-7-7"></a>            <span class="o">*</span><span class="n">cmd</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span>
<a id="__codelineno-7-8" name="__codelineno-7-8"></a>            <span class="n">stdout</span><span class="o">=</span><span class="n">asyncio</span><span class="o">.</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
<a id="__codelineno-7-9" name="__codelineno-7-9"></a>            <span class="n">stderr</span><span class="o">=</span><span class="n">asyncio</span><span class="o">.</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
<a id="__codelineno-7-10" name="__codelineno-7-10"></a>        <span class="p">)</span>
<a id="__codelineno-7-11" name="__codelineno-7-11"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-7-12" name="__codelineno-7-12"></a>        <span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">stack_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-7-13" name="__codelineno-7-13"></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="mi">1</span>
<a id="__codelineno-7-14" name="__codelineno-7-14"></a>    <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span> <span class="o">=</span> <span class="k">await</span> <span class="n">proc</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
<a id="__codelineno-7-15" name="__codelineno-7-15"></a>
<a id="__codelineno-7-16" name="__codelineno-7-16"></a>    <span class="k">return</span> <span class="n">stdout</span><span class="o">.</span><span class="n">decode</span><span class="p">(),</span> <span class="n">stderr</span><span class="o">.</span><span class="n">decode</span><span class="p">(),</span> <span class="n">proc</span><span class="o">.</span><span class="n">returncode</span>
</code></pre></div></td></tr></table></div>
<h2 id="primary-function">Primary Function<a class="headerlink" href="#primary-function" title="Permanent link">🔗</a></h2>
<p>Above in the endpoint code we glossed over the most important details:</p>
<ul>
<li>Clone the repo from <code>code_url</code></li>
<li>Run <code>pipreqs</code> on the cloned repo</li>
</ul>
<p>When we clone a repo we don't need to store its contents forever.
That would take a lot of storage space and each repo will get new commits that invalidate the old downloads anyway.
Making a temporary directory, cloning into it, running <code>pipreqs</code> on it, then deleting it will work just fine.</p>
<p><em>PRE-NOTE:</em> We'll continue to use <code>async</code> functions</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span>
<span class="normal"><a href="#__codelineno-8-2">2</a></span>
<span class="normal"><a href="#__codelineno-8-3">3</a></span>
<span class="normal"><a href="#__codelineno-8-4">4</a></span>
<span class="normal"><a href="#__codelineno-8-5">5</a></span>
<span class="normal"><a href="#__codelineno-8-6">6</a></span>
<span class="normal"><a href="#__codelineno-8-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="kn">import</span> <span class="nn">tempfile</span>
<a id="__codelineno-8-2" name="__codelineno-8-2"></a>
<a id="__codelineno-8-3" name="__codelineno-8-3"></a><span class="k">async</span> <span class="k">def</span> <span class="nf">pipreqs_from_url</span><span class="p">(</span><span class="n">code_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-8-4" name="__codelineno-8-4"></a>    <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">dir_path</span><span class="p">:</span>
<a id="__codelineno-8-5" name="__codelineno-8-5"></a>        <span class="n">old_requirements</span> <span class="o">=</span> <span class="k">await</span> <span class="n">fetch_code</span><span class="p">(</span><span class="n">code_url</span><span class="p">,</span> <span class="n">dir_path</span><span class="p">)</span>
<a id="__codelineno-8-6" name="__codelineno-8-6"></a>        <span class="n">pipreqs_output</span> <span class="o">=</span> <span class="k">await</span> <span class="n">run_pipreqs</span><span class="p">(</span><span class="n">code_url</span><span class="p">,</span> <span class="n">dir_path</span><span class="p">)</span>
<a id="__codelineno-8-7" name="__codelineno-8-7"></a>    <span class="k">return</span> <span class="n">pipreqs_output</span><span class="p">,</span> <span class="n">old_requirements</span>
</code></pre></div></td></tr></table></div>
<p><em>NOTE:</em> We're adding a bit of complexity to prepare for a bot use-case, which is comparing existing <code>requirements.txt</code> to <code>pipreqs</code> result.</p>
<p>To clone the repo and check the contents of <code>requirements.txt</code>, we can do something like this:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-9-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-9-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-9-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-9-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-9-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-9-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-9-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-9-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-9-10">10</a></span>
<span class="normal"><a href="#__codelineno-9-11">11</a></span>
<span class="normal"><a href="#__codelineno-9-12">12</a></span>
<span class="normal"><a href="#__codelineno-9-13">13</a></span>
<span class="normal"><a href="#__codelineno-9-14">14</a></span>
<span class="normal"><a href="#__codelineno-9-15">15</a></span>
<span class="normal"><a href="#__codelineno-9-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="k">async</span> <span class="k">def</span> <span class="nf">fetch_code</span><span class="p">(</span>
<a id="__codelineno-9-2" name="__codelineno-9-2"></a>    <span class="n">code_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">destination_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">requirements_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;requirements.txt&quot;</span>
<a id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-9-4" name="__codelineno-9-4"></a>    <span class="n">clone_cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;git clone --depth 1 </span><span class="si">{</span><span class="n">code_url</span><span class="si">!r}</span><span class="s2"> </span><span class="si">{</span><span class="n">destination_dir</span><span class="si">!r}</span><span class="s2">&quot;</span>
<a id="__codelineno-9-5" name="__codelineno-9-5"></a>    <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span><span class="p">,</span> <span class="n">returncode</span> <span class="o">=</span> <span class="k">await</span> <span class="n">_run</span><span class="p">(</span><span class="n">clone_cmd</span><span class="p">)</span>
<a id="__codelineno-9-6" name="__codelineno-9-6"></a>
<a id="__codelineno-9-7" name="__codelineno-9-7"></a>    <span class="k">if</span> <span class="n">returncode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-9-8" name="__codelineno-9-8"></a>        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Could not clone the code from </span><span class="si">{</span><span class="n">code_url</span><span class="si">!r}</span><span class="s2">!&quot;</span>
<a id="__codelineno-9-9" name="__codelineno-9-9"></a>        <span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">stack_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-9-10" name="__codelineno-9-10"></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="n">message</span><span class="p">)</span>
<a id="__codelineno-9-11" name="__codelineno-9-11"></a>
<a id="__codelineno-9-12" name="__codelineno-9-12"></a>    <span class="n">old_requirements</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">destination_dir</span><span class="p">)</span> <span class="o">/</span> <span class="n">requirements_path</span>
<a id="__codelineno-9-13" name="__codelineno-9-13"></a>    <span class="k">if</span> <span class="n">old_requirements</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
<a id="__codelineno-9-14" name="__codelineno-9-14"></a>        <span class="k">return</span> <span class="n">old_requirements</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span>
<a id="__codelineno-9-15" name="__codelineno-9-15"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-9-16" name="__codelineno-9-16"></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
<p>And to run pipreqs on the directory we just cloned:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1">1</a></span>
<span class="normal"><a href="#__codelineno-10-2">2</a></span>
<span class="normal"><a href="#__codelineno-10-3">3</a></span>
<span class="normal"><a href="#__codelineno-10-4">4</a></span>
<span class="normal"><a href="#__codelineno-10-5">5</a></span>
<span class="normal"><a href="#__codelineno-10-6">6</a></span>
<span class="normal"><a href="#__codelineno-10-7">7</a></span>
<span class="normal"><a href="#__codelineno-10-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="k">async</span> <span class="k">def</span> <span class="nf">run_pipreqs</span><span class="p">(</span><span class="n">code_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dir_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-10-2" name="__codelineno-10-2"></a>    <span class="n">clone_cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;pipreqs --print </span><span class="si">{</span><span class="n">dir_path</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-10-3" name="__codelineno-10-3"></a>    <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span><span class="p">,</span> <span class="n">returncode</span> <span class="o">=</span> <span class="k">await</span> <span class="n">_run</span><span class="p">(</span><span class="n">clone_cmd</span><span class="p">)</span>
<a id="__codelineno-10-4" name="__codelineno-10-4"></a>    <span class="k">if</span> <span class="n">returncode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-10-5" name="__codelineno-10-5"></a>        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Could not run pipreqs on the code from </span><span class="si">{</span><span class="n">code_url</span><span class="si">!r}</span><span class="s2">!&quot;</span>
<a id="__codelineno-10-6" name="__codelineno-10-6"></a>        <span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">stack_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-10-7" name="__codelineno-10-7"></a>        <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="n">message</span><span class="p">)</span>
<a id="__codelineno-10-8" name="__codelineno-10-8"></a>    <span class="k">return</span> <span class="n">stdout</span>
</code></pre></div></td></tr></table></div>
<p><em>POST-NOTE:</em> using HTTPException from FastAPI couples the logic of our program to the API component. I'm fine with this for now, but a more specific error to the function would allow it to be re-used more easily in another app.</p>
<h2 id="caching">Caching<a class="headerlink" href="#caching" title="Permanent link">🔗</a></h2>
<p>If you've written a bot that makes requests to an external API then you might see making unlimited <code>git clone</code> and <code>pipreqs</code> calls as a potential problem.</p>
<p>One strategy to prevent (some) repeated requests to external APIs is by caching results for your server to reference when the same user request comes in.
The Python standard library has <code>functools.lru_cache</code>, but in this case I want the results to expire if the cache becomes too large and also if more than 5 minutes has passed.</p>
<p>I used <code>cachetools</code> library for a tested TTLCache implementation, but to get it to work with an asynchronous function we have to get a little creative.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1">1</a></span>
<span class="normal"><a href="#__codelineno-11-2">2</a></span>
<span class="normal"><a href="#__codelineno-11-3">3</a></span>
<span class="normal"><a href="#__codelineno-11-4">4</a></span>
<span class="normal"><a href="#__codelineno-11-5">5</a></span>
<span class="normal"><a href="#__codelineno-11-6">6</a></span>
<span class="normal"><a href="#__codelineno-11-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="kn">from</span> <span class="nn">cachetools</span> <span class="kn">import</span> <span class="n">TTLCache</span>
<a id="__codelineno-11-2" name="__codelineno-11-2"></a>
<a id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="k">class</span> <span class="nc">RequirementsCache</span><span class="p">(</span><span class="n">TTLCache</span><span class="p">):</span>
<a id="__codelineno-11-4" name="__codelineno-11-4"></a>    <span class="k">def</span> <span class="fm">__missing__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code_url</span><span class="p">):</span>
<a id="__codelineno-11-5" name="__codelineno-11-5"></a>        <span class="n">future</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">pipreqs_from_url</span><span class="p">(</span><span class="n">code_url</span><span class="p">))</span>
<a id="__codelineno-11-6" name="__codelineno-11-6"></a>        <span class="bp">self</span><span class="p">[</span><span class="n">code_url</span><span class="p">]</span> <span class="o">=</span> <span class="n">future</span>
<a id="__codelineno-11-7" name="__codelineno-11-7"></a>        <span class="k">return</span> <span class="n">future</span>
</code></pre></div></td></tr></table></div>
<p>Since <code>cachetools</code> caches act much like a Dictionary, we can overwrite the dunder method that gets called when we try to access a key that doesn't exist!
Here we create a future / task, which is to run the <code>pipreqs_from_url</code> function.</p>
<p>Then we assign that future as the value for the <code>code_url</code> key (so that future checks will access that instead of going to <code>__missing__</code>)</p>
<p>Finally we return the bare future so that we don't lock up the program while executing <code>pipreqs_from_url</code> immediately and synchronously.</p>
<h3 id="singular-cache">Singular Cache<a class="headerlink" href="#singular-cache" title="Permanent link">🔗</a></h3>
<p><code>functools.lru_cache</code> does come in handy for creating an object that serves as a singleton in Python.
We can treat the <code>RequirementsCache</code> for our program this way and make a small, cached wrapper function that returns it once and only once.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span>
<span class="normal"><a href="#__codelineno-12-2">2</a></span>
<span class="normal"><a href="#__codelineno-12-3">3</a></span>
<span class="normal"><a href="#__codelineno-12-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="nd">@functools</span><span class="o">.</span><span class="n">lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="k">def</span> <span class="nf">get_requirements_cache</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">RequirementsCache</span><span class="p">:</span>
<a id="__codelineno-12-3" name="__codelineno-12-3"></a>    <span class="n">requirements_cache</span> <span class="o">=</span> <span class="n">RequirementsCache</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<a id="__codelineno-12-4" name="__codelineno-12-4"></a>    <span class="k">return</span> <span class="n">requirements_cache</span>
</code></pre></div></td></tr></table></div>
<h3 id="using-the-cache">Using the cache<a class="headerlink" href="#using-the-cache" title="Permanent link">🔗</a></h3>
<p>Now we can fill in the API endpoint code!</p>
<p>The wrapper function to fetch the cache is synchronous so we don't need to await <code>get_requirements_cache()</code>.
Then we use Dictionary bracket notation to ask the cache for the <em>future</em>, which we must <code>await</code> to get the actual returned value from <code>pipreqs_from_url</code></p>
<p>The <code>__missing__</code> function we wrote above will get called when a given <code>code_url</code> isn't in the Cache.
Otherwise the cache can return the same future that was stored earlier in <code>__missing__</code>!</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1">1</a></span>
<span class="normal"><a href="#__codelineno-13-2">2</a></span>
<span class="normal"><a href="#__codelineno-13-3">3</a></span>
<span class="normal"><a href="#__codelineno-13-4">4</a></span>
<span class="normal"><a href="#__codelineno-13-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="nd">@router</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/pipreqs&quot;</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">PlainTextResponse</span><span class="p">)</span>
<a id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="k">async</span> <span class="k">def</span> <span class="nf">pipreqs_endpoint</span><span class="p">(</span><span class="n">code_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-13-3" name="__codelineno-13-3"></a>    <span class="n">requirements_cache</span> <span class="o">=</span> <span class="n">get_requirements_cache</span><span class="p">()</span>
<a id="__codelineno-13-4" name="__codelineno-13-4"></a>    <span class="n">requirements</span><span class="p">,</span> <span class="n">old_requirements</span> <span class="o">=</span> <span class="k">await</span> <span class="n">requirements_cache</span><span class="p">[</span><span class="n">code_url</span><span class="p">]</span>
<a id="__codelineno-13-5" name="__codelineno-13-5"></a>    <span class="k">return</span> <span class="n">requirements</span>
</code></pre></div></td></tr></table></div>
<p>For this endpoint the <code>old_requirements</code> isn't useful, so we just return the <code>pipreqs</code> generated requirements.</p>
<h2 id="github-bot">Github Bot<a class="headerlink" href="#github-bot" title="Permanent link">🔗</a></h2>
<p>I followed <a href="https://github-bot-tutorial.readthedocs.io/en/latest/index.html">this guide</a> by Python Core developer and Github Bot builder Mariatta, but adapted it to fit in FastAPI.</p>
<p>The main concept of our bot interaction goes as follows:</p>
<ul>
<li>Whenever there is a push to my repository the bot should be notified with at least the url and whoever made the push</li>
<li>The bot should then run our <code>pipreqs_from_url</code> function on the repository url and this time compare the generated <code>requirements.txt</code> to any existing <code>requirements.txt</code></li>
<li>If there's a difference between the files then the bot should open an Issue on the repository to note the differences</li>
</ul>
<p>Maybe it seems simple in concept but there's a few technical and non-technical aspects to highlight.</p>
<h3 id="webhooks">Webhooks<a class="headerlink" href="#webhooks" title="Permanent link">🔗</a></h3>
<p>Github (among other git hosting services) allows you to set up webhooks on your repositories.
This is the technology that will notify our bot whenever someone pushes a commit.</p>
<p>Webhooks prevent our bot service from having to constantly ping the repository to check for changes.
So long as we trust Github's servers are running correctly, we can be confident that our bot will be notified whenever a push happens.</p>
<p>We can set one up manually in a repo with a secret key to ensure no attacker sends bogus data.
To expand this idea to other users, a Github app or adapting to PubSub might be necessary to ease the creation and access of webhooks.</p>
<p>Check out the webhook <a href="https://docs.github.com/en/developers/webhooks-and-events/webhooks/webhook-events-and-payloads#push">events and payloads documentation</a> for more on what Github will send to our bot.
Which brings us to the next step, what exactly is the bot?</p>
<h3 id="gidgethub-endpoint-the-bot">Gidgethub Endpoint (the bot)<a class="headerlink" href="#gidgethub-endpoint-the-bot" title="Permanent link">🔗</a></h3>
<p>Our bot is actually another FastAPI endpoint!
It's barely a robot at all!</p>
<p>Since we already have a FastAPI server that will be running (to host the main endpoint), it makes sense to me to include our bot as an additional endpoint.
Another strategy would be to utilze a new web server hosted somewhere else to listen for Github's webhook events.</p>
<p>The guide <a href="https://github-bot-tutorial.readthedocs.io/en/latest/gidgethub-for-webhooks.html#">linked above</a> utilizes aiohttp as both the server and the http client for interacting with Github <strong>after</strong> receiving a webhook event (since we'll open an Issue in some cases).
Another option is to use a "serverless" technology such as <a href="https://docs.aws.amazon.com/lambda/latest/dg/lambda-python.html">AWS Lambda</a> as your bot host, which might reduce your server costs if it is idling a lot.</p>
<p>Here's what the endpoint looks like FastAPI / Starlette.
Gidgethub is doing the heavy lifting, we simply pass along request headers and body to the library in order to validate and parse them.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-14-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-14-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-14-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-14-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-14-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-14-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-14-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-14-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-14-10">10</a></span>
<span class="normal"><a href="#__codelineno-14-11">11</a></span>
<span class="normal"><a href="#__codelineno-14-12">12</a></span>
<span class="normal"><a href="#__codelineno-14-13">13</a></span>
<span class="normal"><a href="#__codelineno-14-14">14</a></span>
<span class="normal"><a href="#__codelineno-14-15">15</a></span>
<span class="normal"><a href="#__codelineno-14-16">16</a></span>
<span class="normal"><a href="#__codelineno-14-17">17</a></span>
<span class="normal"><a href="#__codelineno-14-18">18</a></span>
<span class="normal"><a href="#__codelineno-14-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">APIRouter</span><span class="p">,</span> <span class="n">Request</span><span class="p">,</span> <span class="n">Response</span>
<a id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="kn">from</span> <span class="nn">gidgethub</span> <span class="kn">import</span> <span class="n">routing</span><span class="p">,</span> <span class="n">sansio</span>
<a id="__codelineno-14-3" name="__codelineno-14-3"></a>
<a id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="n">router</span> <span class="o">=</span> <span class="n">APIRouter</span><span class="p">()</span>
<a id="__codelineno-14-5" name="__codelineno-14-5"></a><span class="n">gh_router</span> <span class="o">=</span> <span class="n">routing</span><span class="o">.</span><span class="n">Router</span><span class="p">()</span>
<a id="__codelineno-14-6" name="__codelineno-14-6"></a>
<a id="__codelineno-14-7" name="__codelineno-14-7"></a>
<a id="__codelineno-14-8" name="__codelineno-14-8"></a><span class="nd">@router</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="n">response_class</span><span class="o">=</span><span class="n">Response</span><span class="p">)</span>
<a id="__codelineno-14-9" name="__codelineno-14-9"></a><span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="n">Request</span><span class="p">):</span>
<a id="__codelineno-14-10" name="__codelineno-14-10"></a>    <span class="n">body</span> <span class="o">=</span> <span class="k">await</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">()</span>
<a id="__codelineno-14-11" name="__codelineno-14-11"></a>    <span class="n">secret</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;GITHUB_SECRET&quot;</span><span class="p">)</span>
<a id="__codelineno-14-12" name="__codelineno-14-12"></a>    <span class="n">oauth_token</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;GITHUB_TOKEN&quot;</span><span class="p">)</span>
<a id="__codelineno-14-13" name="__codelineno-14-13"></a>    <span class="n">event</span> <span class="o">=</span> <span class="n">sansio</span><span class="o">.</span><span class="n">Event</span><span class="o">.</span><span class="n">from_http</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">secret</span><span class="o">=</span><span class="n">secret</span><span class="p">)</span>
<a id="__codelineno-14-14" name="__codelineno-14-14"></a>    <span class="k">async</span> <span class="k">with</span> <span class="n">httpx</span><span class="o">.</span><span class="n">AsyncClient</span><span class="p">()</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
<a id="__codelineno-14-15" name="__codelineno-14-15"></a>        <span class="n">gh</span> <span class="o">=</span> <span class="n">gidgethub</span><span class="o">.</span><span class="n">httpx</span><span class="o">.</span><span class="n">GitHubAPI</span><span class="p">(</span>
<a id="__codelineno-14-16" name="__codelineno-14-16"></a>            <span class="n">client</span><span class="p">,</span> <span class="s2">&quot;gerardrbentley&quot;</span><span class="p">,</span> <span class="n">oauth_token</span><span class="o">=</span><span class="n">oauth_token</span>
<a id="__codelineno-14-17" name="__codelineno-14-17"></a>        <span class="p">)</span>
<a id="__codelineno-14-18" name="__codelineno-14-18"></a>        <span class="k">await</span> <span class="n">gh_router</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">gh</span><span class="p">)</span>
<a id="__codelineno-14-19" name="__codelineno-14-19"></a>    <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">status_code</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="automatically-opening-an-issue">Automatically Opening an Issue<a class="headerlink" href="#automatically-opening-an-issue" title="Permanent link">🔗</a></h3>
<p>I considered 3 ways to alert the repo owner (myself in this case) of a potential dependency mismatch:</p>
<ul>
<li>Send an email</li>
<li>Open a Pull Request with new <code>requirements.txt</code></li>
<li>Open an Issue with new and old <code>requirements.txt</code></li>
</ul>
<p>Reasons in favor of opening an Issue:</p>
<ul>
<li>There may be Python modules that aren't used in deployment that trigger extra dependencies in pipreqs</li>
<li>A specific older vesion of a package might be required (pipreqs grabs latest version)</li>
<li>Allows the user to set email preferences for alerts</li>
</ul>
<p>The main reasons against opening a Pull Request:</p>
<ul>
<li>Thinking about scaling this bot into a scraper of sorts for other people's projects, it's not always courteous to open a Pull Request without alerting the maintainer in an Issue</li>
<li>Some projects prefer <code>environment.yml</code> or <code>pyproject.toml</code> for dependencies</li>
</ul>
<p>Utilizing <code>gidgethub</code>, we can write a function that responds to any <code>push</code> events to the repository:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-15-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-15-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-15-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-15-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-15-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-15-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-15-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-15-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-15-10">10</a></span>
<span class="normal"><a href="#__codelineno-15-11">11</a></span>
<span class="normal"><a href="#__codelineno-15-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="nd">@gh_router</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;push&quot;</span><span class="p">)</span>
<a id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="k">async</span> <span class="k">def</span> <span class="nf">push_to_repo_event</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">gh</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-15-3" name="__codelineno-15-3"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-15-4" name="__codelineno-15-4"></a><span class="sd">    Whenever a push is made, check the requirements matches pipreqs output; else open an issue.</span>
<a id="__codelineno-15-5" name="__codelineno-15-5"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-15-6" name="__codelineno-15-6"></a>    <span class="n">url</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;repository&quot;</span><span class="p">][</span><span class="s2">&quot;url&quot;</span><span class="p">]</span>
<a id="__codelineno-15-7" name="__codelineno-15-7"></a>    <span class="n">pusher</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;pusher&quot;</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
<a id="__codelineno-15-8" name="__codelineno-15-8"></a>
<a id="__codelineno-15-9" name="__codelineno-15-9"></a>    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
<a id="__codelineno-15-10" name="__codelineno-15-10"></a>        <span class="sa">f</span><span class="s2">&quot;Recent push by @</span><span class="si">{</span><span class="n">pusher</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">! Checking if requirements.txt is in line.&quot;</span>
<a id="__codelineno-15-11" name="__codelineno-15-11"></a>    <span class="p">)</span>
<a id="__codelineno-15-12" name="__codelineno-15-12"></a>    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
<p>Next, we can utilize our <code>requirements_cache</code> the same way as in the API endpoint to fetch the requirements and old_requirements (if present) for the repo.
If our pipreqs requirements match what is in the repo, then there's nothing to do for the bot.
Otherwise, we'll grab the provided url for interacting with Issues in the repo:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1">1</a></span>
<span class="normal"><a href="#__codelineno-16-2">2</a></span>
<span class="normal"><a href="#__codelineno-16-3">3</a></span>
<span class="normal"><a href="#__codelineno-16-4">4</a></span>
<span class="normal"><a href="#__codelineno-16-5">5</a></span>
<span class="normal"><a href="#__codelineno-16-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1"></a>    <span class="n">requirements_cache</span> <span class="o">=</span> <span class="n">get_requirements_cache</span><span class="p">()</span>
<a id="__codelineno-16-2" name="__codelineno-16-2"></a>    <span class="n">requirements</span><span class="p">,</span> <span class="n">old_requirements</span> <span class="o">=</span> <span class="k">await</span> <span class="n">requirements_cache</span><span class="p">[</span><span class="n">url</span><span class="p">]</span>
<a id="__codelineno-16-3" name="__codelineno-16-3"></a>    <span class="k">if</span> <span class="n">requirements</span> <span class="o">==</span> <span class="n">old_requirements</span><span class="p">:</span>
<a id="__codelineno-16-4" name="__codelineno-16-4"></a>        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Requirements satisfied in repo </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-16-5" name="__codelineno-16-5"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-16-6" name="__codelineno-16-6"></a>        <span class="n">issues_url</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;repository&quot;</span><span class="p">][</span><span class="s2">&quot;issues_url&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
<p>Finally, we'll write a short message and use the <code>gh</code> http client to make the POST request to alert the repository owner and whoever submitted the push!</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-17-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-17-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-17-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-17-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-17-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-17-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-17-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-17-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-17-10">10</a></span>
<span class="normal"><a href="#__codelineno-17-11">11</a></span>
<span class="normal"><a href="#__codelineno-17-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1"></a>        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-17-2" name="__codelineno-17-2"></a>            <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Check dependencies&quot;</span><span class="p">,</span>
<a id="__codelineno-17-3" name="__codelineno-17-3"></a>            <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<a id="__codelineno-17-4" name="__codelineno-17-4"></a><span class="s2">⚠️ Warning! Please confirm dependencies are satisfied.</span>
<a id="__codelineno-17-5" name="__codelineno-17-5"></a><span class="s2">Requirements generated by pipreqs:</span>
<a id="__codelineno-17-6" name="__codelineno-17-6"></a>
<a id="__codelineno-17-7" name="__codelineno-17-7"></a><span class="s2">```txt</span>
<a id="__codelineno-17-8" name="__codelineno-17-8"></a><span class="si">{</span><span class="n">requirements</span><span class="si">}</span>
<a id="__codelineno-17-9" name="__codelineno-17-9"></a><span class="s2">```&quot;&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-17-10" name="__codelineno-17-10"></a>            <span class="s2">&quot;assignees&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">pusher</span><span class="p">],</span>
<a id="__codelineno-17-11" name="__codelineno-17-11"></a>        <span class="p">}</span>
<a id="__codelineno-17-12" name="__codelineno-17-12"></a>        <span class="k">await</span> <span class="n">gh</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">issues_url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h2 id="testing">Testing<a class="headerlink" href="#testing" title="Permanent link">🔗</a></h2>
<p>We can use <code>pytest</code> and a handful of its helpers to make testing the API and subprocess calls a bit easier:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1">1</a></span>
<span class="normal"><a href="#__codelineno-18-2">2</a></span>
<span class="normal"><a href="#__codelineno-18-3">3</a></span>
<span class="normal"><a href="#__codelineno-18-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1"></a>pytest==7.1.1
<a id="__codelineno-18-2" name="__codelineno-18-2"></a>pytest-asyncio==0.18.3
<a id="__codelineno-18-3" name="__codelineno-18-3"></a>pytest-cov==3.0.0
<a id="__codelineno-18-4" name="__codelineno-18-4"></a>pytest-mock==3.7.0
</code></pre></div></td></tr></table></div>
<p>By using a <code>conftest.py</code> we can prepare a Starlette test client for testing the API endpoints:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-19-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-19-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-19-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-19-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-19-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-19-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-19-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-19-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-19-10">10</a></span>
<span class="normal"><a href="#__codelineno-19-11">11</a></span>
<span class="normal"><a href="#__codelineno-19-12">12</a></span>
<span class="normal"><a href="#__codelineno-19-13">13</a></span>
<span class="normal"><a href="#__codelineno-19-14">14</a></span>
<span class="normal"><a href="#__codelineno-19-15">15</a></span>
<span class="normal"><a href="#__codelineno-19-16">16</a></span>
<span class="normal"><a href="#__codelineno-19-17">17</a></span>
<span class="normal"><a href="#__codelineno-19-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="c1"># conftest.py</span>
<a id="__codelineno-19-2" name="__codelineno-19-2"></a><span class="kn">import</span> <span class="nn">pytest</span>
<a id="__codelineno-19-3" name="__codelineno-19-3"></a><span class="kn">from</span> <span class="nn">fastapi.testclient</span> <span class="kn">import</span> <span class="n">TestClient</span>
<a id="__codelineno-19-4" name="__codelineno-19-4"></a>
<a id="__codelineno-19-5" name="__codelineno-19-5"></a><span class="kn">from</span> <span class="nn">app.config</span> <span class="kn">import</span> <span class="n">Settings</span><span class="p">,</span> <span class="n">get_settings</span>
<a id="__codelineno-19-6" name="__codelineno-19-6"></a><span class="kn">from</span> <span class="nn">app.main</span> <span class="kn">import</span> <span class="n">create_application</span>
<a id="__codelineno-19-7" name="__codelineno-19-7"></a>
<a id="__codelineno-19-8" name="__codelineno-19-8"></a>
<a id="__codelineno-19-9" name="__codelineno-19-9"></a><span class="k">def</span> <span class="nf">get_settings_override</span><span class="p">():</span>
<a id="__codelineno-19-10" name="__codelineno-19-10"></a>    <span class="k">return</span> <span class="n">Settings</span><span class="p">(</span><span class="n">testing</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-19-11" name="__codelineno-19-11"></a>
<a id="__codelineno-19-12" name="__codelineno-19-12"></a>
<a id="__codelineno-19-13" name="__codelineno-19-13"></a><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s2">&quot;module&quot;</span><span class="p">)</span>
<a id="__codelineno-19-14" name="__codelineno-19-14"></a><span class="k">def</span> <span class="nf">test_app</span><span class="p">():</span>
<a id="__codelineno-19-15" name="__codelineno-19-15"></a>    <span class="n">app</span> <span class="o">=</span> <span class="n">create_application</span><span class="p">()</span>
<a id="__codelineno-19-16" name="__codelineno-19-16"></a>    <span class="n">app</span><span class="o">.</span><span class="n">dependency_overrides</span><span class="p">[</span><span class="n">get_settings</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_settings_override</span>
<a id="__codelineno-19-17" name="__codelineno-19-17"></a>    <span class="k">with</span> <span class="n">TestClient</span><span class="p">(</span><span class="n">app</span><span class="p">)</span> <span class="k">as</span> <span class="n">test_client</span><span class="p">:</span>
<a id="__codelineno-19-18" name="__codelineno-19-18"></a>        <span class="k">yield</span> <span class="n">test_client</span>
</code></pre></div></td></tr></table></div>
<p>Then in our <code>test_pipreqsapi.py</code> we need to make sure to cue <code>pytest-asyncio</code> and clear the cache after each test in order to validate call counts:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1">1</a></span>
<span class="normal"><a href="#__codelineno-20-2">2</a></span>
<span class="normal"><a href="#__codelineno-20-3">3</a></span>
<span class="normal"><a href="#__codelineno-20-4">4</a></span>
<span class="normal"><a href="#__codelineno-20-5">5</a></span>
<span class="normal"><a href="#__codelineno-20-6">6</a></span>
<span class="normal"><a href="#__codelineno-20-7">7</a></span>
<span class="normal"><a href="#__codelineno-20-8">8</a></span>
<span class="normal"><a href="#__codelineno-20-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1"></a><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
<a id="__codelineno-20-2" name="__codelineno-20-2"></a><span class="k">class</span> <span class="nc">TestPipreqsApi</span><span class="p">:</span>
<a id="__codelineno-20-3" name="__codelineno-20-3"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Test backend logic that handles cloning repos and running pipreqs&quot;&quot;&quot;</span>
<a id="__codelineno-20-4" name="__codelineno-20-4"></a>
<a id="__codelineno-20-5" name="__codelineno-20-5"></a>    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">(</span><span class="n">autouse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-20-6" name="__codelineno-20-6"></a>    <span class="k">def</span> <span class="nf">clear_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-20-7" name="__codelineno-20-7"></a>        <span class="k">yield</span>
<a id="__codelineno-20-8" name="__codelineno-20-8"></a>        <span class="n">cache</span> <span class="o">=</span> <span class="n">get_requirements_cache</span><span class="p">()</span>
<a id="__codelineno-20-9" name="__codelineno-20-9"></a>        <span class="n">cache</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<p>From there we can test each function, building up to the main endpoint.
We'll include general tests on whether things succeed when given good inputs or mocks and whether they fail with the intended errors when bad things happen.</p>
<p>Testing our async subprocess run is a good example.
Here we use known command <code>ls</code> and broken command <code>lz</code> to verify our function responds as we expect.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1">1</a></span>
<span class="normal"><a href="#__codelineno-21-2">2</a></span>
<span class="normal"><a href="#__codelineno-21-3">3</a></span>
<span class="normal"><a href="#__codelineno-21-4">4</a></span>
<span class="normal"><a href="#__codelineno-21-5">5</a></span>
<span class="normal"><a href="#__codelineno-21-6">6</a></span>
<span class="normal"><a href="#__codelineno-21-7">7</a></span>
<span class="normal"><a href="#__codelineno-21-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1"></a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_async_run_succeeds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-21-2" name="__codelineno-21-2"></a>        <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span><span class="p">,</span> <span class="n">resultcode</span> <span class="o">=</span> <span class="k">await</span> <span class="n">_run</span><span class="p">(</span><span class="s2">&quot;ls&quot;</span><span class="p">)</span>
<a id="__codelineno-21-3" name="__codelineno-21-3"></a>        <span class="k">assert</span> <span class="n">resultcode</span> <span class="o">==</span> <span class="mi">0</span>
<a id="__codelineno-21-4" name="__codelineno-21-4"></a>
<a id="__codelineno-21-5" name="__codelineno-21-5"></a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_async_run_fails_bad_command</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-21-6" name="__codelineno-21-6"></a>        <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span><span class="p">,</span> <span class="n">resultcode</span> <span class="o">=</span> <span class="k">await</span> <span class="n">_run</span><span class="p">(</span><span class="s2">&quot;lz&quot;</span><span class="p">)</span>
<a id="__codelineno-21-7" name="__codelineno-21-7"></a>        <span class="k">assert</span> <span class="n">resultcode</span> <span class="o">==</span> <span class="mi">1</span>
<a id="__codelineno-21-8" name="__codelineno-21-8"></a>        <span class="k">assert</span> <span class="n">stderr</span> <span class="o">==</span> <span class="s2">&quot;[Errno 2] No such file or directory: &#39;lz&#39;&quot;</span>
</code></pre></div></td></tr></table></div>
<p>(I don't include git clone here since it needs to go out to an external server without other setup / guarantees.
It's definitely worth an end to end test though at some point.)</p>
<p>We can use monkeypatching to fake an expected result now that we've verified our <code>_run</code> function works.
This next test assumes we cloned the repo and that it didn't have an existing <code>requirements.txt</code>:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1">1</a></span>
<span class="normal"><a href="#__codelineno-22-2">2</a></span>
<span class="normal"><a href="#__codelineno-22-3">3</a></span>
<span class="normal"><a href="#__codelineno-22-4">4</a></span>
<span class="normal"><a href="#__codelineno-22-5">5</a></span>
<span class="normal"><a href="#__codelineno-22-6">6</a></span>
<span class="normal"><a href="#__codelineno-22-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1"></a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_fetch_code_succeeds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">monkeypatch</span><span class="p">):</span>
<a id="__codelineno-22-2" name="__codelineno-22-2"></a>        <span class="k">async</span> <span class="k">def</span> <span class="nf">fake_run_success</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
<a id="__codelineno-22-3" name="__codelineno-22-3"></a>            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">0</span>
<a id="__codelineno-22-4" name="__codelineno-22-4"></a>
<a id="__codelineno-22-5" name="__codelineno-22-5"></a>        <span class="n">monkeypatch</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="n">pipreqsapi</span><span class="p">,</span> <span class="s2">&quot;_run&quot;</span><span class="p">,</span> <span class="n">fake_run_success</span><span class="p">)</span>
<a id="__codelineno-22-6" name="__codelineno-22-6"></a>        <span class="n">res</span> <span class="o">=</span> <span class="k">await</span> <span class="n">fetch_code</span><span class="p">(</span><span class="s2">&quot;good_clone_url&quot;</span><span class="p">,</span> <span class="s2">&quot;none&quot;</span><span class="p">)</span>
<a id="__codelineno-22-7" name="__codelineno-22-7"></a>        <span class="k">assert</span> <span class="n">res</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
<p>To simulate the case where there is a <code>requirements.txt</code> we could set up a dummy repo with one or use mocking to pretend that any Path from pathlib can find it and read it:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-23-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-23-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-23-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-23-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-23-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-23-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-23-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-23-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-23-10">10</a></span>
<span class="normal"><a href="#__codelineno-23-11">11</a></span>
<span class="normal"><a href="#__codelineno-23-12">12</a></span>
<span class="normal"><a href="#__codelineno-23-13">13</a></span>
<span class="normal"><a href="#__codelineno-23-14">14</a></span>
<span class="normal"><a href="#__codelineno-23-15">15</a></span>
<span class="normal"><a href="#__codelineno-23-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="n">MOCK_REQS</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;fastapi==0.75.1</span>
<a id="__codelineno-23-2" name="__codelineno-23-2"></a><span class="s2">gunicorn==20.1.0</span>
<a id="__codelineno-23-3" name="__codelineno-23-3"></a><span class="s2">pipreqs==0.4.11</span>
<a id="__codelineno-23-4" name="__codelineno-23-4"></a><span class="s2">uvicorn==0.17.6&quot;&quot;&quot;</span>
<a id="__codelineno-23-5" name="__codelineno-23-5"></a><span class="o">...</span>
<a id="__codelineno-23-6" name="__codelineno-23-6"></a>
<a id="__codelineno-23-7" name="__codelineno-23-7"></a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_fetch_code_returns_requirements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">monkeypatch</span><span class="p">,</span> <span class="n">mocker</span><span class="p">):</span>
<a id="__codelineno-23-8" name="__codelineno-23-8"></a>        <span class="k">async</span> <span class="k">def</span> <span class="nf">fake_run_success</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
<a id="__codelineno-23-9" name="__codelineno-23-9"></a>            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">0</span>
<a id="__codelineno-23-10" name="__codelineno-23-10"></a>
<a id="__codelineno-23-11" name="__codelineno-23-11"></a>        <span class="n">monkeypatch</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="n">pipreqsapi</span><span class="p">,</span> <span class="s2">&quot;_run&quot;</span><span class="p">,</span> <span class="n">fake_run_success</span><span class="p">)</span>
<a id="__codelineno-23-12" name="__codelineno-23-12"></a>        <span class="n">mocker</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">object</span><span class="p">(</span><span class="n">Path</span><span class="p">,</span> <span class="s2">&quot;is_file&quot;</span><span class="p">,</span> <span class="n">return_value</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-23-13" name="__codelineno-23-13"></a>        <span class="n">mocker</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">object</span><span class="p">(</span><span class="n">Path</span><span class="p">,</span> <span class="s2">&quot;read_text&quot;</span><span class="p">,</span> <span class="n">return_value</span><span class="o">=</span><span class="n">MOCK_REQS</span><span class="p">)</span>
<a id="__codelineno-23-14" name="__codelineno-23-14"></a>
<a id="__codelineno-23-15" name="__codelineno-23-15"></a>        <span class="n">res</span> <span class="o">=</span> <span class="k">await</span> <span class="n">fetch_code</span><span class="p">(</span><span class="s2">&quot;good_clone_url&quot;</span><span class="p">,</span> <span class="s2">&quot;none&quot;</span><span class="p">)</span>
<a id="__codelineno-23-16" name="__codelineno-23-16"></a>        <span class="k">assert</span> <span class="n">res</span> <span class="o">==</span> <span class="n">MOCK_REQS</span>
</code></pre></div></td></tr></table></div>
<p>We can also use mocking to keep track of how many times a function gets called.
This is useful for validating that our cache will not call the same function twice when it has the value cached already.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-24-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-24-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-24-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-24-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-24-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-24-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-24-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-24-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-24-10">10</a></span>
<span class="normal"><a href="#__codelineno-24-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1"></a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_requirements_cache_caches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mocker</span><span class="p">):</span>
<a id="__codelineno-24-2" name="__codelineno-24-2"></a>        <span class="n">mock_pipreqs_from_url</span> <span class="o">=</span> <span class="n">mocker</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span>
<a id="__codelineno-24-3" name="__codelineno-24-3"></a>            <span class="s2">&quot;app.pipreqsapi.pipreqs_from_url&quot;</span><span class="p">,</span> <span class="n">return_value</span><span class="o">=</span><span class="n">MOCK_REQS</span>
<a id="__codelineno-24-4" name="__codelineno-24-4"></a>        <span class="p">)</span>
<a id="__codelineno-24-5" name="__codelineno-24-5"></a>        <span class="n">cache</span> <span class="o">=</span> <span class="n">get_requirements_cache</span><span class="p">()</span>
<a id="__codelineno-24-6" name="__codelineno-24-6"></a>        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">cache</span><span class="p">[</span><span class="s2">&quot;good_clone_url&quot;</span><span class="p">]</span>
<a id="__codelineno-24-7" name="__codelineno-24-7"></a>        <span class="n">second_result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">cache</span><span class="p">[</span><span class="s2">&quot;good_clone_url&quot;</span><span class="p">]</span>
<a id="__codelineno-24-8" name="__codelineno-24-8"></a>        <span class="k">assert</span> <span class="n">result</span> <span class="o">==</span> <span class="n">MOCK_REQS</span>
<a id="__codelineno-24-9" name="__codelineno-24-9"></a>        <span class="n">mock_pipreqs_from_url</span><span class="o">.</span><span class="n">assert_called_once_with</span><span class="p">(</span><span class="s2">&quot;good_clone_url&quot;</span><span class="p">)</span>
<a id="__codelineno-24-10" name="__codelineno-24-10"></a>        <span class="k">assert</span> <span class="n">second_result</span> <span class="o">==</span> <span class="n">MOCK_REQS</span>
<a id="__codelineno-24-11" name="__codelineno-24-11"></a>        <span class="n">mock_pipreqs_from_url</span><span class="o">.</span><span class="n">assert_called_once_with</span><span class="p">(</span><span class="s2">&quot;good_clone_url&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>Finally for the endpoints we'll need to rely on the <code>test_app</code> established in <code>conftest.py</code>.
We can assert things about the status and any expected errors:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-25-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-25-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-25-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-25-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-25-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-25-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-25-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-25-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-25-10">10</a></span>
<span class="normal"><a href="#__codelineno-25-11">11</a></span>
<span class="normal"><a href="#__codelineno-25-12">12</a></span>
<span class="normal"><a href="#__codelineno-25-13">13</a></span>
<span class="normal"><a href="#__codelineno-25-14">14</a></span>
<span class="normal"><a href="#__codelineno-25-15">15</a></span>
<span class="normal"><a href="#__codelineno-25-16">16</a></span>
<span class="normal"><a href="#__codelineno-25-17">17</a></span>
<span class="normal"><a href="#__codelineno-25-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1"></a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_pipreqs_endpoint_succeeds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test_app</span><span class="p">,</span> <span class="n">monkeypatch</span><span class="p">):</span>
<a id="__codelineno-25-2" name="__codelineno-25-2"></a>        <span class="k">async</span> <span class="k">def</span> <span class="nf">fake_pipreqs_from_url_success</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
<a id="__codelineno-25-3" name="__codelineno-25-3"></a>            <span class="k">return</span> <span class="p">(</span><span class="n">MOCK_REQS</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-25-4" name="__codelineno-25-4"></a>
<a id="__codelineno-25-5" name="__codelineno-25-5"></a>        <span class="n">monkeypatch</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span>
<a id="__codelineno-25-6" name="__codelineno-25-6"></a>            <span class="n">pipreqsapi</span><span class="p">,</span> <span class="s2">&quot;pipreqs_from_url&quot;</span><span class="p">,</span> <span class="n">fake_pipreqs_from_url_success</span>
<a id="__codelineno-25-7" name="__codelineno-25-7"></a>        <span class="p">)</span>
<a id="__codelineno-25-8" name="__codelineno-25-8"></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">test_app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/pipreqs&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;code_url&quot;</span><span class="p">:</span> <span class="s2">&quot;good_clone_url&quot;</span><span class="p">})</span>
<a id="__codelineno-25-9" name="__codelineno-25-9"></a>        <span class="k">assert</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span>
<a id="__codelineno-25-10" name="__codelineno-25-10"></a>        <span class="k">assert</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span> <span class="o">==</span> <span class="n">MOCK_REQS</span>
<a id="__codelineno-25-11" name="__codelineno-25-11"></a>
<a id="__codelineno-25-12" name="__codelineno-25-12"></a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_pipreqs_endpoint_fails_bad_repo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test_app</span><span class="p">):</span>
<a id="__codelineno-25-13" name="__codelineno-25-13"></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">test_app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/pipreqs&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;code_url&quot;</span><span class="p">:</span> <span class="s2">&quot;bad_clone_url&quot;</span><span class="p">})</span>
<a id="__codelineno-25-14" name="__codelineno-25-14"></a>        <span class="k">assert</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">400</span>
<a id="__codelineno-25-15" name="__codelineno-25-15"></a>        <span class="k">assert</span> <span class="p">(</span>
<a id="__codelineno-25-16" name="__codelineno-25-16"></a>            <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;detail&quot;</span><span class="p">]</span>
<a id="__codelineno-25-17" name="__codelineno-25-17"></a>            <span class="o">==</span> <span class="s2">&quot;Could not clone the code from &#39;bad_clone_url&#39;!&quot;</span>
<a id="__codelineno-25-18" name="__codelineno-25-18"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h2 id="next-steps">Next Steps<a class="headerlink" href="#next-steps" title="Permanent link">🔗</a></h2>
<p>Overall this was a fun project for creating a FastAPI server with caching and async distributed transactions.</p>
<p>It also got me to think about github bots a bit and how we might clean up Python repos going forward.</p>
<h3 id="bot">Bot<a class="headerlink" href="#bot" title="Permanent link">🔗</a></h3>
<p>This server works for exposing the pipreqs functionality via API, but the bot leaves some steps to be desired.
As of now the <code>gidgethub</code> handling relies on my own github account's access token and the webhooks are validated based on the secret established for my particular repo.</p>
<p>The bot might be better applied as a Github App to allow users to more easily click a button and get the functionality.</p>
<h3 id="api">API<a class="headerlink" href="#api" title="Permanent link">🔗</a></h3>
<p>Adding features already available in pipreqs would be straightforward with further optional query params:</p>
<ul>
<li>min / compatible version options</li>
<li>using non-pypi package host</li>
</ul>
<p>Adding features not already in pipreqs would be more involved or hacky:</p>
<ul>
<li>Convert from <code>requirements.txt</code> to <code>pyproject.toml</code> / <code>environment.yml</code></li>
<li>Async parsing and fetching package info</li>
</ul>
<p>Another idea is on-demand Issue / Pull requests on a given repo (for helping out others without putting too much effor in yourself)</p>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">June 7, 2023</span>
      
        <br>
        Created:
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">June 7, 2023</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../personal-domain/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Share a website to the world in less than a day (Free for Students!)" rel="prev">
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <div class="md-ellipsis">
                <span class="md-footer__direction">
                  Previous
                </span>
                Share a website to the world in less than a day (Free for Students!)
              </div>
            </div>
          </a>
        
        
          
          <a href="../python-form-generator/" class="md-footer__link md-footer__link--next" aria-label="Next: Python Form Generator (JSON to Streamlit Form!)" rel="next">
            <div class="md-footer__title">
              <div class="md-ellipsis">
                <span class="md-footer__direction">
                  Next
                </span>
                Python Form Generator (JSON to Streamlit Form!)
              </div>
            </div>
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2020 - 2023 Gerard Bentley
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://gerardbentley.com/@gar" target="_blank" rel="noopener" title="gerardbentley.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://twitter.com/garsbar35plus" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://github.com/gerardrbentley" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://www.linkedin.com/in/gerardrbentley/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.indexes", "navigation.instant", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.footer", "navigation.tracking", "toc.follow", "search.suggest", "search.highlight", "search.share", "header.autohide"], "search": "../../assets/javascripts/workers/search.12658920.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.5cf534bf.min.js"></script>
      
    
  </body>
</html>